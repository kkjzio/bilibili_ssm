<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns:th="http://www.thymeleaf.org">
<head th:href="${#request.getContextPath()}+'/'">
    <base href="<%=basePath%>">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <link rel="stylesheet"
          th:href="@{/static/User_Data_Update/css/jiazaitoubu.css}"
          type="text/css"/>
    <link rel="stylesheet"
          th:href="@{/static/User_Data_Update/css/css.css}"
          type="text/css"/>
    <link rel="stylesheet"
          th:href="@{/static/User_Data_Update/css/center.css}"
          type="text/css"/>
    <link rel="stylesheet"
          th:href="@{/static/User_Data_Update/city/city.css}"
          type="text/css"/>

    <!-- <script src="<%=request.getContextPath()%>/static/User_Data_Update/"></script> -->
    <script
            th:src="@{/static/User_Data_Update/js/jquery-1.8.3.min.js}"></script>
    <script
            th:src="@{/static/User_Data_Update/js/index2.js}"></script>
    <script
            th:src="@{/static/User_Data_Update/js/index2.js}"></script>

    <style>
        .mbox {
            height: 23px;
            border: 1px solid #eaeaea;
            width: 140px;
        }

    </style>


    <title>屄哩屄哩-信息修改</title>
</head>
<body>
<div class="top" id="wyqtb">
    <!--热门搜索-->

    <!--导航-->
    <div class="dao_hang" style="background-color: #6C89B2;">


        <!--结束-->
        <div class="dao_list">
            <a href="index.sf">首页</a> <a href="favourite.sf">视频收藏</a> <a href="videoManege.sf">投稿管理</a>
        </div>
    </div>
</div>
<!-- 	<script>
window.onload=function(){
	$(".aside").css({display:"none"})
	$(".important").mouseenter(function(){
		$(".aside").css({display:"block"})
		}).mouseleave(function(){
			$(".aside").css({display:"none"})
			})
	}
</script> -->
<!--当前位置-->
<div class="now_positionm">
    <span>当前位置：</span><a href="index.sf">首页></a><a
        href="User_full_information.sf">个人中心</a>
</div>
<!--centers-->
<div class="centers_m">
    <!--清除浮动-->
    <div class="clear_sm"></div>
    <!--left-->
    <div class="centers_ml">
        <!--头像-->
        <div class="center_header">
            <a href="User_full_information.sf"><img
                    th:src="${#session.getAttribute('userHand')}"/></a>
            <em>您好，[[${#session.getAttribute('userName')}]]</em> <font
                style="color: red; font-size: 11px;">(下方可修改资料~喵)</font>
        </div>
        <!--列表go-->
        <div class="centers_listm">
            <div class="centers_listm_one">
                <img
                        th:src="@{/static/User_Data_Update/images/zshy.png}"/>
                <em>会员中心</em>
            </div>
            <!--一条开始-->
            <div class="centers_listm_one_in">
                <img
                        th:src="@{/static/User_Data_Update/images/shezhi.png}"/>
                <em>资料管理</em> <b></b>
            </div>
            <span class="gjszmdm"> <a href="Information.sf"
                                      class="center_in_self"><font>信息资料</font></a>
				</span>


            <!--一条开始-->
            <div class="centers_listm_one_in">
                <img
                        th:src="@{/static/User_Data_Update/images/wdssc.png}"/>
                <em>收藏管理</em>
            </div>
            <span class="gjszmdm"> <a href="favourite.sf" class="center_in_self"><font>视频收藏</font></a>
                <a href="videoManege.sf" class="center_in_self"><font>投稿管理</font></a>
				</span>

        </div>
        <script type="text/javascript">
            $(function () {//第一步都得写这个
                $(".centers_listm_one_in").click(function () {
                    $(this).next(".gjszmdm").slideToggle().siblings("gjszmdm").slideUp()
                });
            })
        </script>
    </div>
    <!--一条开始-->
    <div class="public_m1">
        <div class="public_m2">用户全部信息资料</div>
        <!--提示信息-->
        <div class="tip_notem">
            <ul>
                <li>1.请牢记支付密码</li>
                <li>2.如果丢失密码，可以通过绑定的手机或邮箱找到</li>
            </ul>
        </div>
        <div class="public_m4">

            <form id="upload_form">
                <p>
                    <em>用户名：</em>
                    <input type="text" name="userName"
                           class="mbox" id="name"
                           th:value="${user.userName}">
                </p>
                <p>
                    <em>用户地址：</em>
                    <input type="text" name="userAddress"
                           class="mbox" id="address"
                           th:value="${user.userAddress}">
                </p>
                <p>
                    <em>用户手机号：</em>
                    <input type="text" name="userPhone"
                           class="mbox" id="phone"
                           th:value="${user.userPhone}">
                </p>
                <p>
                    <em>用户QQ号：</em>
                    <input type="text" name="userQQ"
                           class="mbox" id="qq"
                           th:value="${user.userQQ}">
                </p>
                <p>
                    <em>用户邮箱：</em>
                    <input type="text" name="userEmial"
                           class="mbox" id="email"
                           th:value="${user.userEmial}">
                </p>
                <p>
                    <em>用户状态：</em>
                    <input type="text" name="userState"
                           class="mbox" id="state"
                           th:value="${user.userState}" onfocus=this.blur()>
                </p>
                <input type="button" class="public_m3" id="upForm" value="提交修改"/>
                <a href="User_full_information.sf" class="public_m3">返回主信息</a>

            </form>

             <!--提交的ajax-->
            <script>

                //form序列化为json common.js
                $.fn.serializeObject = function() {
                    var o = {};
                    var a = this.serializeArray();
                    $.each(a, function () {
                        if (o[this.name] !== undefined) {
                            if (!o[this.name].push) {
                                o[this.name] = [o[this.name]];
                            }
                            o[this.name].push(this.value || '');
                        } else {
                            o[this.name] = this.value || '';
                        }
                    });
                    return o;
                };


                $("#upForm").click(function () {
                    // 判断表格是否为空
                    var forms = document.forms;
                    for(var f=0;f<forms.length;f++){
                        var form = document.forms[f];
                        if(form.value == ""){
                            alert(form.id+" 不能为空！");
                            return false;
                        }
                    }

                    // ajax上传
                    var formdata = $("#upload_form").serializeObject();
                    $.ajax({
                        url: 'ajaxInformationUp',
                        type: 'POST',
                        // dataType: "json", // 接收的返回类型 默认String
                        data: JSON.stringify(formdata), // 将js对象转换为json
                        contentType: "application/json; charset=utf-8", //必须这样写POST  会加在header中
                        success: function (returndata) {
                            alert("结果为"+returndata);
                            location.href = "Information.sf";
                            return true;
                        },
                        error: function (returndata) {
                            // console.log("returndata is :" + returndata)
                            alert("修改失败"+returndata);
                            return false;
                        }
                    })

                })

            </script>

        </div>
    </div>
</body>
</html>